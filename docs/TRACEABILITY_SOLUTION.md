# æª”æ¡ˆè¿½æº¯æ€§è§£æ±ºæ–¹æ¡ˆ

## ğŸ“Š ç•¶å‰ç‹€æ³åˆ†æ

### æª”æ¡ˆçµ±è¨ˆ
- **åŸå§‹é€å­—ç¨¿ç¸½æ•¸**: 211å€‹
  - æœ‰ç·¨è™Ÿ (1-95): 84å€‹
  - ç„¡ç·¨è™Ÿ: 127å€‹
  - é‡è¤‡å…§å®¹: 1å€‹ï¼ˆ30èˆ‡65é‡è¤‡ï¼‰
  - **ç¨ç‰¹å…§å®¹**: 210å€‹

- **å·²æ•´ç†æª”æ¡ˆ**: 200å€‹
  - 1-95ç¯„åœ: 94å€‹ï¼ˆå°‘1å€‹å› 65é‡è¤‡è¢«åˆªï¼‰
  - 96-211ç¯„åœ: 106å€‹
  - ç¼ºå¤±ç·¨è™Ÿ: [167, 168, 169, 170, 171, 172, 173, 174, 175, 205]ï¼ˆ10å€‹é‡è¤‡è¢«åˆªï¼‰

### âœ… çµè«–ï¼šæ‰€æœ‰210å€‹ç¨ç‰¹å…§å®¹éƒ½å·²æ•´ç†å®Œæˆ

åˆªé™¤çš„11å€‹æª”æ¡ˆåˆ†æï¼š
- **65è™Ÿ**: èˆ‡30è™Ÿå°æ‡‰åŒä¸€å€‹åŸå§‹ç¨¿ï¼ˆåŸå§‹ç¨¿é‡è¤‡ï¼‰
- **167-175, 205** (10å€‹): æ•´ç†éç¨‹ä¸­ç”¢ç”Ÿçš„é‡è¤‡æª”æ¡ˆ

**æ²’æœ‰ç¼ºå¤±çš„æª”æ¡ˆï¼** 210å€‹ç¨ç‰¹å…§å®¹ - 10å€‹é‡è¤‡ = 200å€‹å·²æ•´ç†æª”æ¡ˆ âœ“

## ğŸ” ç•¶å‰å•é¡Œ

### å•é¡Œ1ï¼šç„¡æ³•è¿½æº¯ä¾†æº
- AIæ•´ç†å¾Œæ¨™é¡Œå¤§å¹…æ”¹å¯«
- ç„¡æ³•å¿«é€Ÿæ‰¾åˆ°æ•´ç†æª”æ¡ˆå°æ‡‰çš„åŸå§‹é€å­—ç¨¿
- ä¾‹å¦‚ï¼š
  - åŸå§‹ï¼š`å…¬å›­ç¬¬ä¸€é›†ï½œç›´é£ï¼š æ”¶è…¿çš„æ—¶æœºå†³å®šä½ ç¨³ä¸ç¨³.txt`
  - æ•´ç†å¾Œï¼š`111_ç›´è·³æ”¶è…¿æ™‚æ©Ÿ__L-int__S-green-blue-park.md`

### å•é¡Œ2ï¼šæœªä¾†æ–°å¢é€å­—ç¨¿æ™‚çš„æŒ‘æˆ°
- å¦‚ä½•çŸ¥é“å“ªäº›å·²æ•´ç†ã€å“ªäº›æœªæ•´ç†ï¼Ÿ
- å¦‚ä½•é¿å…é‡è¤‡æ•´ç†ï¼Ÿ
- å¦‚ä½•ç¶­è­·å°æ‡‰é—œä¿‚ï¼Ÿ

## ğŸ’¡ è§£æ±ºæ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šåœ¨JSON Metadataä¸­åŠ å…¥ä¾†æºè³‡è¨Šï¼ˆæ¨è–¦ï¼‰

#### ä¿®æ”¹å¾Œçš„JSONæ ¼å¼ï¼š
```json
{
  "source_file": "å…¬å›­ç¬¬ä¸€é›†ï½œç›´é£ï¼š æ”¶è…¿çš„æ—¶æœºå†³å®šä½ ç¨³ä¸ç¨³.txt",
  "source_checksum": "abc123...",
  "processed_date": "2024-11-25",
  "Core_Competency": "å±…ä¸­ä¸”éˆæ´»çš„ç«™å§¿",
  "Fault_What": "ç›´è·³æ”¶è…¿éæ—©è…¿è·‘åœ¨ä¸ŠåŠèº«å‰ä¸ç©©",
  ...
}
```

#### å„ªé»ï¼š
- âœ… æ¯å€‹æ•´ç†æª”æ¡ˆéƒ½å¯è¿½æº¯å›åŸå§‹ç¨¿
- âœ… ä½¿ç”¨ checksum å¯æª¢æ¸¬åŸå§‹ç¨¿æ˜¯å¦æ›´æ–°
- âœ… è‡ªåŒ…å«ï¼Œä¸éœ€è¦é¡å¤–çš„å°æ‡‰è¡¨æª”æ¡ˆ
- âœ… æœªä¾†æŸ¥è©¢æ™‚å¯å¿«é€Ÿéæ¿¾

### æ–¹æ¡ˆäºŒï¼šç¶­è­·å°æ‡‰è¡¨æª”æ¡ˆ

å‰µå»º `source_mapping.json`:
```json
{
  "111": {
    "cleaned_file": "111_ç›´è·³æ”¶è…¿æ™‚æ©Ÿ__L-int__S-green-blue-park.md",
    "source_file": "å…¬å›­ç¬¬ä¸€é›†ï½œç›´é£ï¼š æ”¶è…¿çš„æ—¶æœºå†³å®šä½ ç¨³ä¸ç¨³.txt",
    "checksum": "abc123..."
  },
  ...
}
```

#### å„ªé»ï¼š
- âœ… é›†ä¸­ç®¡ç†æ‰€æœ‰å°æ‡‰é—œä¿‚
- âœ… æ˜“æ–¼æŸ¥è©¢å’Œç¶­è­·
- âœ… ä¸ä¿®æ”¹ç¾æœ‰æª”æ¡ˆçµæ§‹

#### ç¼ºé»ï¼š
- âš ï¸ éœ€è¦é¡å¤–ç¶­è­·ä¸€å€‹æª”æ¡ˆ
- âš ï¸ å°æ‡‰è¡¨èˆ‡æª”æ¡ˆå¯èƒ½ä¸åŒæ­¥

### æ–¹æ¡ˆä¸‰ï¼šæª”æ¡ˆå‘½åè¦å‰‡ï¼ˆæœ€ç°¡å–®ï¼‰

åœ¨æ•´ç†æ™‚ï¼Œå°‡åŸå§‹æª”åçš„hashåŠ å…¥æª”åï¼š
```
111_ç›´è·³æ”¶è…¿æ™‚æ©Ÿ_[abc12]__L-int__S-green-blue-park.md
                  ^^^^^^
                  åŸå§‹æª”åhashå‰6ç¢¼
```

## ğŸš€ æ¨è–¦å¯¦æ–½æ­¥é©Ÿ

### éšæ®µä¸€ï¼šè£œå®Œç¾æœ‰200å€‹æª”æ¡ˆçš„ä¾†æºè³‡è¨Š

1. **å‰µå»ºå…§å®¹ç‰¹å¾µæ¯”å°å·¥å…·**
   ```python
   # æå–åŸå§‹ç¨¿å‰500å­—å…ƒä½œç‚ºfingerprint
   # åœ¨æ•´ç†ç¨¿çš„ Drill_How ä¸­æœå°‹ç›¸ä¼¼å…§å®¹
   # ç›¸ä¼¼åº¦>60% å³è¦–ç‚ºåŒ¹é…
   ```

2. **ç”Ÿæˆå°æ‡‰è¡¨**
   - è‡ªå‹•æ¯”å°ï¼šåŒ¹é…æˆåŠŸç´„80-90%
   - æ‰‹å‹•æ ¸å°ï¼šå‰©é¤˜10-20%ä¸ç¢ºå®šçš„

3. **æ›´æ–°æª”æ¡ˆ**
   - é¸é …Aï¼šåœ¨JSONä¸­åŠ å…¥ `source_file` æ¬„ä½
   - é¸é …Bï¼šå‰µå»º `source_mapping.json`

### éšæ®µäºŒï¼šæœªä¾†æ–°å¢é€å­—ç¨¿çš„å·¥ä½œæµç¨‹

```bash
# 1. æ”¾ç½®æ–°çš„é€å­—ç¨¿åˆ° sam/new/ ç›®éŒ„
# 2. åŸ·è¡Œæ•´ç†è…³æœ¬
python process_new_transcripts.py

# è…³æœ¬æœƒï¼š
# - æª¢æŸ¥ sam/new/ ä¸­çš„æ–°æª”æ¡ˆ
# - è¨ˆç®—checksumï¼Œæª¢æŸ¥æ˜¯å¦å·²æ•´ç†é
# - å‘¼å«AIæ•´ç†
# - è‡ªå‹•åŠ å…¥ source_file åˆ°JSON
# - åˆ†é…æ–°çš„ç·¨è™Ÿ
# - ç§»å‹•åŸå§‹ç¨¿åˆ° sam/processed/
```

### éšæ®µä¸‰ï¼šå»ºç«‹æª¢æŸ¥æ©Ÿåˆ¶

```python
# å®šæœŸåŸ·è¡Œæª¢æŸ¥è…³æœ¬
python check_integrity.py

# æª¢æŸ¥ï¼š
# 1. æ¯å€‹æ•´ç†æª”æ¡ˆéƒ½æœ‰å°æ‡‰çš„åŸå§‹ç¨¿
# 2. æ¯å€‹åŸå§‹ç¨¿éƒ½å·²è¢«æ•´ç†
# 3. æ²’æœ‰é‡è¤‡çš„å…§å®¹
# 4. Checksumæ˜¯å¦è®Šæ›´ï¼ˆåŸå§‹ç¨¿è¢«ä¿®æ”¹ï¼‰
```

## ğŸ“ å…·é«”ç¨‹å¼ç¢¼ç¯„ä¾‹

### å…§å®¹æ¯”å°å·¥å…·
```python
def find_source_file(cleaned_md_path):
    """æ ¹æ“šæ•´ç†æª”æ¡ˆæ‰¾åˆ°å°æ‡‰çš„åŸå§‹é€å­—ç¨¿"""
    # 1. æå–æ•´ç†æª”æ¡ˆçš„ Drill_How å…§å®¹
    drill_content = extract_drill_how(cleaned_md_path)

    # 2. èˆ‡æ‰€æœ‰åŸå§‹ç¨¿æ¯”å°
    best_match = None
    best_score = 0

    for sam_file in glob.glob('sam/*.txt'):
        with open(sam_file) as f:
            sam_content = f.read()[:1000]  # å‰1000å­—å…ƒ

        # ä½¿ç”¨æ¨¡ç³Šæ¯”å°
        score = calculate_similarity(drill_content, sam_content)

        if score > best_score:
            best_score = score
            best_match = sam_file

    return best_match, best_score
```

### æ›´æ–°JSONåŠ å…¥ä¾†æº
```python
def add_source_to_json(md_file, source_file):
    """åœ¨markdownçš„JSONä¸­åŠ å…¥source_fileæ¬„ä½"""
    with open(md_file, 'r') as f:
        content = f.read()

    # æå–JSON
    json_start = content.find('```json') + 7
    json_end = content.find('```', json_start)
    json_data = json.loads(content[json_start:json_end])

    # åŠ å…¥ä¾†æºè³‡è¨Š
    json_data['source_file'] = Path(source_file).name
    json_data['source_checksum'] = calculate_md5(source_file)

    # æ›´æ–°æª”æ¡ˆ
    new_json = json.dumps(json_data, ensure_ascii=False, indent=2)
    new_content = content[:json_start] + new_json + content[json_end:]

    with open(md_file, 'w') as f:
        f.write(new_content)
```

## ğŸ¯ ç«‹å³è¡Œå‹•é …ç›®

1. âœ… **ç¢ºèªæ²’æœ‰ç¼ºå¤±**ï¼šå·²å®Œæˆï¼Œ210å€‹ç¨ç‰¹å…§å®¹éƒ½å·²æ•´ç†
2. â³ **å‰µå»ºå°æ‡‰è¡¨**ï¼šç‚ºç¾æœ‰200å€‹æª”æ¡ˆå»ºç«‹ä¾†æºå°æ‡‰
3. â³ **æ›´æ–°JSONæ ¼å¼**ï¼šåŠ å…¥ source_file æ¬„ä½
4. â³ **å»ºç«‹è‡ªå‹•åŒ–æµç¨‹**ï¼šæœªä¾†æ–°å¢é€å­—ç¨¿çš„è™•ç†è…³æœ¬

---

**æ—¥æœŸ**: 2024-11-26
**æª”æ¡ˆå®Œæ•´æ€§ç‹€æ…‹**: âœ… å®Œæ•´ï¼ˆ210/210å·²æ•´ç†ï¼‰
**è¿½æº¯æ€§ç‹€æ…‹**: âš ï¸ å¾…å»ºç«‹
