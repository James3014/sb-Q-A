# Day 16-20 QA + 性能優化測試計畫

**日期**: 2025-12-08 - Day 16-20 (預計)
**版本**: 調整③ 儀表板強化 (Development Phase)
**狀態**: 🔄 準備 QA 測試

---

## 📋 QA 測試清單

### 1️⃣ 功能測試

#### A. 練習頻率分析組件 (PracticeAnalytics.tsx)

**測試場景 1：無資料狀態**
```
前置條件：用戶未有任何練習記錄
預期結果：
  ✓ 顯示「尚無練習記錄」友善提示
  ✓ 顯示「至少需要 3 次練習」說明文字
  ✓ 文字居中，UI 美觀
```

**測試場景 2：有資料狀態**
```
前置條件：用戶有 5+ 次練習記錄，涉及 3+ 個不同技能
預期結果：
  ✓ 按練習次數排序（降冪）顯示前 10 個技能
  ✓ 顯示項目：技能名稱 + 練習次數 + 平均評分 + 最後練習時間
  ✓ 進度條寬度按練習次數比例自適應
  ✓ 進度條色彩漸層（藍→紫→粉）
  ✓ 每個技能卡片有 Framer Motion 動畫進場效果
  ✓ 評分顯示 2 位小數點
  ✓ 日期格式為 MM-DD HH:MM（台灣在地化）
  ✓ 底部統計摘要正確（總技能數、總練習次、平均評分）
```

**測試場景 3：動畫效果**
```
預期結果：
  ✓ 卡片順序進場（0.08s 間隔）
  ✓ 進度條寬度動畫平滑（0.8s，easeOut）
  ✓ 閃光效果循環流動（2s，無限循環）
  ✓ 無卡頓（60fps）
```

---

#### B. 技能進步曲線圖組件 (SkillImprovementChart.tsx)

**測試場景 1：無資料狀態**
```
前置條件：選擇某技能，但該技能無練習記錄
預期結果：
  ✓ 顯示「『技能名』尚無練習數據」友善提示
  ✓ 顯示「練習此技能後將出現進度曲線」說明
```

**測試場景 2：單日資料**
```
前置條件：技能只有 1 天練習記錄
預期結果：
  ✓ 顯示 1 個柱狀條
  ✓ 柱狀條高度正確對應評分
  ✓ 進步指示器為 → (無進步也無後退)
  ✓ 起始評分 = 最新評分
```

**測試場景 3：完整時間序列（15+ 天）**
```
前置條件：技能有 15+ 天的練習數據，評分呈上升趨勢（3.0 → 4.2）
預期結果：
  ✓ 柱狀圖順序正確排列（時間遞增）
  ✓ 柱狀條高度按評分縮放（1-5 分映射 0-100% 高度）
  ✓ 所有柱狀條有梯度色（red → pink）
  ✓ Hover 時顯示 Tooltip：日期 + 評分 + 練習次數
  ✓ Tooltip 動畫平滑（200ms）
  ✓ 進步指示器為 ↗️（綠色，顯示 +1.2）
  ✓ 底部卡片顯示：起始評分 + 進度 + 最新評分
  ✓ 統計摘要：練習天數 + 練習次數 + 平均評分 + 評分範圍
```

**測試場景 4：下降趨勢**
```
前置條件：評分從 4.5 下降到 3.1
預期結果：
  ✓ 進步指示器為 ↘️（琥珀色，顯示 -1.4）
  ✓ 中間卡片背景邊框為琥珀色
```

**測試場景 5：動畫與互動**
```
預期結果：
  ✓ 柱狀條順序進場（每個 40ms 延遲）
  ✓ 柱狀條 Hover 時放大（scaleY 1.1）
  ✓ Hover 時卡片上邊界發光
  ✓ 無卡頓（60fps）
```

---

#### C. 儀表板整合 (ImprovementDashboard.tsx)

**測試場景 1：初次載入**
```
前置條件：第一次進入練習中心，已登入 PRO 用戶
預期結果：
  ✓ 自動載入練習頻率分析
  ✓ 顯示載入中動畫（旋轉圓環）
  ✓ 加載完後自動選擇練習最多的技能
  ✓ 同時載入該技能的進步曲線圖
```

**測試場景 2：技能選擇器**
```
前置條件：練習頻率分析已載入（3+ 個技能）
預期結果：
  ✓ 顯示技能按鈕列表
  ✓ 點擊技能後切換進度曲線圖
  ✓ 當前選中技能為紅色漸層 + 放大效果（scale 1.05）
  ✓ 未選中技能為灰色 + 邊框
  ✓ 過渡動畫平滑（200ms）
```

**測試場景 3：組件順序**
```
預期結果：
  ✓ 原有組件順序不變：
    1. ImprovementSummary
    2. StatsOverview
    3. SkillDistribution
    4. WeaknessAlert
    5. 久未練習提示（如需要）
  ✓ 新增組件插入位置：
    6. PracticeAnalytics（新）
    7. 技能選擇器（新）
    8. SkillImprovementChart（新）
    9. PracticeTrend（原）
   10. RecentPracticeList（原）
```

---

#### D. 練習頁面 (app/practice/page.tsx)

**測試場景 1：未登入用戶**
```
前置條件：未登入，訪問 /practice
預期結果：
  ✓ 顯示 LockedState 組件
  ✓ 標題：「練習紀錄為付費功能」
  ✓ 按鈕：「登入」
```

**測試場景 2：免費用戶 - 儀表板標籤**
```
前置條件：以免費用戶身份登入，進入 /practice
預期結果：
  ✓ 顯示 LockedDashboardPreview 組件
  ✓ 顯示模糊遮罩 + 解鎖訊息
  ✓ 訊息包含：功能列表（4 項）+ 升級按鈕
  ✓ 升級按鈕點擊後導向 /pricing
  ✓ 背景有骨架圖表（示意用）
  ✓ 下方顯示 2 個卡片：基礎功能 + 升級解鎖
```

**測試場景 3：免費用戶 - 練習紀錄標籤**
```
前置條件：以免費用戶身份登入，進入 /practice，點擊「練習紀錄」標籤
預期結果：
  ✓ 顯示 PracticeLogs 組件
  ✓ 顯示用戶的所有練習紀錄
  ✓ 功能正常（不受 PRO 限制）
```

**測試場景 4：PRO 用戶**
```
前置條件：以 PRO 用戶身份登入，進入 /practice
預期結果：
  ✓ 顯示完整 ImprovementDashboard 組件
  ✓ 顯示所有分析功能（無鎖定）
  ✓ 練習頻率分析 + 進度曲線圖正常顯示
```

**測試場景 5：訂閱狀態切換**
```
前置條件：登入為免費用戶，然後升級為 PRO
預期結果：
  ✓ 頁面自動刷新或更新
  ✓ 從預覽模式切換到完整儀表板
  ✓ 分析數據正確載入
```

---

### 2️⃣ 性能測試

#### A. 載入時間測試

**測試項目：練習頻率分析載入時間**
```
工具：Chrome DevTools Network 標籤
預期結果：
  ✓ RPC 查詢 API 響應時間 < 500ms
  ✓ 組件渲染時間 < 300ms
  ✓ 從 /practice 進入到完整顯示 < 1s
```

**測試項目：進度曲線圖載入時間**
```
預期結果：
  ✓ 單個技能曲線 RPC 查詢 < 400ms
  ✓ 曲線圖渲染 < 200ms
  ✓ 技能切換時延遲 < 600ms
```

#### B. 動畫性能測試

**工具**：Chrome DevTools Performance 標籤

**測試場景 1：進度條動畫**
```
前置條件：PracticeAnalytics 有 3+ 個技能
預期結果：
  ✓ 幀速率穩定在 60fps
  ✓ 無頻繁的 GPU 重排
  ✓ 內存佔用 < 10MB
```

**測試場景 2：柱狀圖動畫**
```
前置條件：SkillImprovementChart 有 20+ 天數據
預期結果：
  ✓ 幀速率 ≥ 50fps（允許略低，因為元素多）
  ✓ 無卡頓感
```

**測試場景 3：Tooltip Hover**
```
前置條件：SkillImprovementChart 中 Hover 柱狀條
預期結果：
  ✓ Tooltip 出現延遲 < 50ms
  ✓ 動畫平滑，無跳幀
```

#### C. 組件重渲染測試

**工具**：React DevTools Profiler

**測試場景：技能選擇切換**
```
預期結果：
  ✓ 點擊新技能後，只有以下組件重渲染：
    - ImprovementDashboard（狀態更新）
    - SkillImprovementChart（新數據）
  ✓ 其他組件不重渲染（PracticeAnalytics、技能選擇器等）
  ✓ 每次切換耗時 < 200ms
```

---

### 3️⃣ 手機端測試 (iOS/Android)

#### A. 響應式設計驗證

**測試設備**：iPhone 12 (390x844)、iPhone SE (375x667)、Android 手機 (360x800)

**測試項目 1：版面布局**
```
PracticeAnalytics:
  ✓ 技能條文字不換行（寬度足夠）
  ✓ 進度條清晰可見
  ✓ 評分數字對齐
  ✓ 無水平捲動

SkillImprovementChart:
  ✓ 圖表寬度自適應（全屏）
  ✓ Y 軸標籤清晰
  ✓ 柱狀條間距適當
  ✓ 無重疊

技能選擇器：
  ✓ 按鈕換行適當（2-3 行）
  ✓ 按鈕大小可觸控（min 44x44px）
```

**測試項目 2：互動觸控**
```
預期結果：
  ✓ 技能選擇器按鈕可靠地響應點擊
  ✓ 無誤觸
  ✓ Tooltip 在 Touch 設備上可見（或替代方案）
  ✓ 滑動流暢，無延遲感
```

#### B. 手機性能測試

**工具**：Chrome 遠程調試、Lighthouse

**測試項目：LCP (Largest Contentful Paint)**
```
前置條件：在 iPhone 12 上加載練習頁面
預期結果：
  ✓ LCP 時間 < 3s
  ✓ 手機上無明顯卡頓
```

**測試項目：CLS (Cumulative Layout Shift)**
```
預期結果：
  ✓ CLS < 0.1
  ✓ 頁面載入時沒有版面抖動
```

---

### 4️⃣ 邊界情況測試

#### A. 數據邊界

**測試場景 1：一個技能**
```
前置條件：用戶只練習過 1 個技能，該技能有 1 次記錄
預期結果：
  ✓ PracticeAnalytics 只顯示 1 個技能卡片
  ✓ 技能選擇器只有 1 個按鈕
  ✓ 進度曲線圖顯示 1 個柱狀條
  ✓ 進度指示器為 → (無進步)
```

**測試場景 2：超大量數據**
```
前置條件：用戶有 50+ 次練習（30+ 個技能），時間跨度 30 天
預期結果：
  ✓ PracticeAnalytics 只顯示前 10 個技能（按限制）
  ✓ 加載時間仍 < 1s
  ✓ 滾動流暢
```

**測試場景 3：極高評分**
```
前置條件：某日練習評分全是 5.0
預期結果：
  ✓ 曲線圖柱狀條高度正確（100% 高度）
  ✓ Tooltip 顯示 5.0 ⭐
  ✓ 統計摘要顯示正確
```

**測試場景 4：極低評分**
```
前置條件：某日練習評分全是 1.0
預期結果：
  ✓ 曲線圖柱狀條高度正確（最小高度）
  ✓ 進度指示器正確（如果有上升則 ↗️）
```

#### B. 日期邊界

**測試場景 1：跨月份**
```
前置條件：數據跨越 11 月和 12 月
預期結果：
  ✓ 日期顯示正確（11-30 → 12-01）
  ✓ 時間序列邏輯正確
```

**測試場景 2：今天**
```
前置條件：數據包含今天的練習
預期結果：
  ✓ 最新評分顯示今天的日期
  ✓ 最後練習時間正確顯示
```

---

### 5️⃣ 相容性測試

#### A. 瀏覽器相容性

**測試瀏覽器**：
- Chrome 最新版 (Desktop)
- Firefox 最新版
- Safari 最新版 (macOS + iOS)
- Edge 最新版

**測試項目**：
```
✓ CSS 漸層正確渲染
✓ Framer Motion 動畫流暢
✓ SVG/路徑元素正確
✓ 沒有控制台錯誤
```

#### B. 長度與語言

**測試場景 1：長技能名稱**
```
前置條件：技能名稱超過 20 字符（e.g., "非常高級的螺旋轉彎技巧分析")
預期結果：
  ✓ 按鈕文字換行或截斷（加省略號）
  ✓ 版面不破裂
```

**測試場景 2：中文 vs 英文混合**
```
前置條件：技能名稱包含中英混合（e.g., "Carving 刻滑")
預期結果：
  ✓ 顯示正確
  ✓ 無奇怪的字間距
```

---

## 🔧 性能優化待辦項

### 已完成的優化
- [x] SQL 查詢使用複合索引（`idx_practice_logs_user_created`）
- [x] SQL 函數限制結果數量（前 10 個技能）
- [x] Framer Motion 動畫使用 GPU 加速
- [x] React 元件記憶化（防止不必要重渲染）

### 建議進一步優化
- [ ] **虛擬化列表**：如果技能數量超過 20，考慮用 react-window 虛擬化
- [ ] **數據緩存**：在用戶 1 小時內重複訪問相同技能時，使用本地緩存
- [ ] **圖表優化**：如果 30+ 天數據，考慮降採樣（e.g., 隔日採樣）
- [ ] **CSS 動畫替代**：某些 Framer Motion 動畫可替換為純 CSS，效能更好
- [ ] **代碼分割**：Dashboard 組件可 lazy-load

---

## 📊 測試報告模板

### 自動化測試執行記錄

```
【測試項目】練習頻率分析 - 完整數據渲染
【前置條件】5 個技能，各 10+ 次練習
【執行時間】2025-12-XX
【結果】✅ PASS / ❌ FAIL

【詳細結果】
  ✓ 組件正確渲染
  ✓ 動畫無卡頓（60fps）
  ✓ 加載時間 < 500ms

【發現的問題】(如有)
  - [問題描述]
  - 復現步驟：...
  - 建議修復：...
```

### 手動測試執行記錄

```
【測試環境】iPhone 12 Safari
【測試時間】2025-12-XX
【頁面】/practice (儀表板標籤)

【測試場景】技能選擇器交互
  ✓ 按鈕點擊響應
  ✓ 曲線圖更新
  ✓ 無視覺抖動

【發現的問題】(如有)
  - Tooltip 在手機上被頁面邊界截斷
  - 建議修復：Tooltip 改為出現在下方
```

---

## 📝 驗收標準

### QA 通過標準

**功能測試**：
- ✅ 所有 5 個測試場景 PASS（A-D 組件）
- ✅ 沒有功能性 Bug（Critical + High）
- ✅ 邊界情況處理恰當

**性能測試**：
- ✅ 加載時間 < 1s
- ✅ 動畫幀速率 ≥ 50fps
- ✅ 無內存洩漏

**手機端測試**：
- ✅ iOS + Android 都可用
- ✅ LCP < 3s，CLS < 0.1
- ✅ 觸控互動正常

**相容性測試**：
- ✅ Chrome/Firefox/Safari/Edge 都可用
- ✅ 無控制台 Critical 錯誤
- ✅ 國際化（中文顯示正確）

### 簽核人

```
【開發】Claude Code - 2025-12-08
【QA】[待簽核]
【上線負責人】[待簽核]
```

---

## 🎯 下一步（Day 21-25）

如果 QA 通過，進行：
1. **上線物料準備**（文檔、營銷素材）
2. **監控與告警設置**（Sentry、DataDog）
3. **客服培訓**（新功能說明）
4. **備份與回滾計畫**（以防 Day 30 出錯）

---

**文檔生成日期**：2025-12-08
**計畫版本**：v1.0
**預計完成**：Day 20 2025-12-27
