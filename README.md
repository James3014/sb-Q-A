# ğŸ‚ å–®æ¿æ•™å­¸ App

æ»‘é›ªæ¿æ•™å­¸å…§å®¹ç®¡ç†ç³»çµ±ï¼ŒåŸºæ–¼ CASI èªè­‰æ•™å­¸æ¡†æ¶ã€‚å°ˆç‚ºé›ªå ´ä½¿ç”¨è¨­è¨ˆï¼Œæ‰‹æ©Ÿå„ªå…ˆçš„ UIã€‚

## ğŸ¯ ä½¿ç”¨æƒ…å¢ƒ

- ğŸš¡ çºœè»Šä¸Šå¿«é€ŸæŸ¥æ‰¾å•é¡Œè§£æ³•
- ğŸ§¤ æˆ´æ‰‹å¥—æ“ä½œï¼ˆå¤§æŒ‰éˆ• â‰¥44pxã€å¤§è§¸æ§å€ï¼‰
- â˜€ï¸ å¼·å…‰ä¸‹é–±è®€ï¼ˆé«˜å°æ¯”æ·±è‰²ä¸»é¡Œï¼‰
- â±ï¸ æ‰¾åˆ°å•é¡Œ â†’ çœ‹è§£æ³• â†’ é¦¬ä¸Šç·´
- ğŸ“¶ å¼±ç¶²ç’°å¢ƒï¼ˆè‡ªå‹•é‡è©¦æ©Ÿåˆ¶ï¼‰

---

## ğŸŒ Web ç‰ˆæœ¬ (Next.js)

### æŠ€è¡“æ£§

| å±¤ç´š | æŠ€è¡“ |
|------|------|
| å‰ç«¯ | Next.js 15 + React 19 + TypeScript |
| æ¨£å¼ | Tailwind CSSï¼ˆæ·±è‰²ä¸»é¡Œï¼‰ |
| å¾Œç«¯ | Supabase (PostgreSQL + Auth + RLS) |
| éƒ¨ç½² | Zeabur |
| å‹•ç•« | Framer Motion |

### UX ç‰¹è‰²ï¼ˆé›ªå ´å„ªåŒ–ï¼‰

| ç‰¹è‰² | èªªæ˜ |
|------|------|
| è§¸æ§ç›®æ¨™ â‰¥44px | æ‰€æœ‰æŒ‰éˆ•ç¬¦åˆ WCAG æ¨™æº– |
| åº•éƒ¨å›ºå®šæ“ä½œæ¬„ | å®Œæˆç·´ç¿’æŒ‰éˆ•ä¸æœƒæ¼æ‰ |
| Skeleton è¼‰å…¥ | éª¨æ¶å±å–ä»£ã€Œè¼‰å…¥ä¸­ã€æ–‡å­— |
| éœ‡å‹•å›é¥‹ | Android é»æ“ŠæŒ‰éˆ•æœ‰è§¸è¦ºå›é¥‹ |
| é«˜å°æ¯”åº¦ | ä¸»æŒ‰éˆ• blue-700/green-700 |
| çœé›»æ¨¡å¼ | æ”¯æ´ prefers-reduced-motion |
| å¼±ç¶²é‡è©¦ | fetchWithRetry è‡ªå‹•é‡è©¦ |
| éŒ¯èª¤é‚Šç•Œ | ErrorBoundary é˜²æ­¢ç™½å± |

### ğŸ¨ Alpine Velocity ç¾å­¸ç³»çµ±

**è¨­è¨ˆç†å¿µ**ï¼šé€Ÿåº¦æ„Ÿ + æ»‘é›ªå ´è¦–è¦º + æ‰‹æ©Ÿå„ªå…ˆ

| å…ƒç´  | ç‰¹è‰² |
|------|------|
| å­—é«”ç³»çµ± | Bebas Neueï¼ˆDisplayï¼‰+ Space Monoï¼ˆBodyï¼‰ |
| å¡ç‰‡è¨­è¨ˆ | æ–œåˆ‡è§’é‚Šç·£ã€é€Ÿåº¦å…‰æšˆã€3 å±¤å…‰å½±æ•ˆæœ |
| å‹•ç•«æ•ˆæœ | æ»¾å‹•æ–œå‘æ»‘å…¥ã€3 ç§’è„ˆå‹•å…‰æšˆã€é»æ“Šé€Ÿåº¦å…‰æšˆ |
| Snow Mode | é ‚éƒ¨ç’°å¢ƒå…‰æšˆã€æ–‡å­—é™°å½±å¼·åŒ– |
| å¿«é€Ÿå…¥å£ | å„ªå…ˆæŒ‰éˆ•è¦–è¦ºå·®ç•°åŒ–ã€è§¸è¦ºå›é¥‹ |
| è©•åˆ† | 9.6/10ï¼ˆFrontend Design Skillï¼‰ |

### åŠŸèƒ½æ¶æ§‹

```
å‰å°åŠŸèƒ½
â”œâ”€â”€ é¦–é  - èª²ç¨‹åˆ—è¡¨ã€æœå°‹ã€åˆ†é¡ç¯©é¸
â”œâ”€â”€ èª²ç¨‹è©³æƒ… - å•é¡Œ/ç›®æ¨™/ç·´ç¿’æ–¹æ³•/åšå°åšéŒ¯è¨Šè™Ÿ
â”œâ”€â”€ æ”¶è— - å€‹äººæ”¶è—æ¸…å–®ï¼ˆéœ€ç™»å…¥ï¼‰
â”œâ”€â”€ ç·´ç¿’ç´€éŒ„ - ç´€éŒ„æ¯æ¬¡ç·´ç¿’å¿ƒå¾—ï¼ˆéœ€ç™»å…¥ï¼‰
â”œâ”€â”€ ä»˜è²»æ–¹æ¡ˆ - 7å¤©/30å¤©/å¹´è²»è¨‚é–±
â””â”€â”€ æ„è¦‹å›å ± - Bug/èª²ç¨‹è¨±é¡˜/åŠŸèƒ½è¨±é¡˜

å¾Œå°åŠŸèƒ½ (/admin)
â”œâ”€â”€ Dashboard - DAU/WAUã€ç†±é–€èª²ç¨‹ã€ç†±é–€æœå°‹ã€å¿«é€Ÿæ´å¯Ÿ
â”œâ”€â”€ ç”¨æˆ¶ç®¡ç† - æœå°‹ç”¨æˆ¶ã€æ‰‹å‹•é–‹é€šè¨‚é–±
â”œâ”€â”€ å›å ±ç®¡ç† - æŸ¥çœ‹/ç¯©é¸ç”¨æˆ¶å›å ±
â”œâ”€â”€ èª²ç¨‹åˆ†æ - ç†±é–€/æœ‰æ•ˆåº¦/å¥åº·åº¦/ç†±åŠ›åœ–
â””â”€â”€ ä»˜è²»åˆ†æ - è½‰æ›ç‡ã€æ–¹æ¡ˆåˆ†å¸ƒã€æ¼æ–—
```

### ğŸ“Š å¾Œå°æ•¸æ“šåˆ†æç³»çµ±

ç”¨æ–¼äº†è§£ç”¨æˆ¶è¡Œç‚ºï¼Œæ”¹å–„èª²ç¨‹å…§å®¹ã€‚

#### è¿½è¹¤äº‹ä»¶

| äº‹ä»¶ | èªªæ˜ | ç”¨é€” |
|------|------|------|
| `view_lesson` | ç€è¦½èª²ç¨‹ï¼ˆå«ä¾†æºï¼‰ | çŸ¥é“ç”¨æˆ¶å¾å“ªé€²å…¥èª²ç¨‹ |
| `search_keyword` | æœå°‹é—œéµå­— | äº†è§£ç”¨æˆ¶åœ¨æ‰¾ä»€éº¼ |
| `search_no_result` | æœå°‹ç„¡çµæœ | ç™¼ç¾å…§å®¹ç¼ºå£ |
| `scroll_depth` | æ»¾å‹•æ·±åº¦ï¼ˆ25/50/75/100%ï¼‰ | åˆ¤æ–·å…§å®¹æ˜¯å¦å¤ªé•· |
| `practice_start` | é–‹å§‹ç·´ç¿’ | è¨ˆç®—ç·´ç¿’å®Œæˆç‡ |
| `practice_complete` | å®Œæˆç·´ç¿’ï¼ˆå«è©•åˆ†ï¼‰ | è©•ä¼°èª²ç¨‹æœ‰æ•ˆåº¦ |

#### Dashboard é¢æ¿

| é¢æ¿ | å…§å®¹ | è¡Œå‹•å»ºè­° |
|------|------|---------|
| ğŸ’¡ å¿«é€Ÿæ´å¯Ÿ | è‡ªå‹•åˆ†ææ•¸æ“šçµ¦å‡ºå»ºè­° | ç›´æ¥çœ‹å»ºè­°è¡Œå‹• |
| ğŸ” å…§å®¹ç¼ºå£ | æœå°‹ç„¡çµæœ TOP 10 | æ–°å¢é€™äº›ä¸»é¡Œçš„èª²ç¨‹ |
| ğŸ“Š èª²ç¨‹ä¾†æº | é¦–é /æœå°‹/åˆ†é¡/ç›¸é—œèª²ç¨‹ä½”æ¯” | å„ªåŒ–é«˜æ•ˆå…¥å£ |
| ğŸ”¥ ç†±é–€èª²ç¨‹ | ç€è¦½æ¬¡æ•¸æ’è¡Œ | äº†è§£ç”¨æˆ¶éœ€æ±‚ |
| ğŸ” ç†±é–€æœå°‹ | æœå°‹é—œéµå­—æ’è¡Œ | å„ªåŒ–èª²ç¨‹æ¨™é¡Œ |

#### èª²ç¨‹åˆ†æ Tab

| Tab | æŒ‡æ¨™ | åˆ¤è®€æ–¹å¼ |
|-----|------|---------|
| ğŸ“Š ç†±é–€ | ç€è¦½/ç·´ç¿’/æ”¶è—æ•¸ | é«˜ç€è¦½ä½ç·´ç¿’ = å…§å®¹å¯èƒ½å¤ªé›£ |
| ğŸ¯ æœ‰æ•ˆåº¦ | ç”¨æˆ¶ç·´ç¿’å¾Œè©•åˆ† | ä½åˆ† = å…§å®¹ä¸æ¸…æ¥šï¼Œéœ€é‡å¯« |
| ğŸ©º å¥åº·åº¦ | æ»¾å‹•å®Œæˆç‡ Ã— 40% + ç·´ç¿’å®Œæˆç‡ Ã— 60% | ä½åˆ† = éœ€è¦æ”¹å–„çš„èª²ç¨‹ |
| ğŸ”¥ ç†±åŠ›åœ– | è¦–è¦ºåŒ–èª²ç¨‹è¡¨ç¾ | å¿«é€Ÿæ‰¾å‡ºå†·é–€èª²ç¨‹ |

#### å¿«é€Ÿæ´å¯Ÿé‚è¼¯

è‡ªå‹•åˆ†ææ•¸æ“šï¼Œçµ¦å‡ºå¯è¡Œå‹•å»ºè­°ï¼š

```
1. å…§å®¹ç¼ºå£æé†’
   æ¢ä»¶ï¼šæœå°‹ç„¡çµæœæ¬¡æ•¸ > 0
   å»ºè­°ï¼šã€ŒXXX è¢«æœå°‹ N æ¬¡ä½†æ‰¾ä¸åˆ°ï¼Œè€ƒæ…®æ–°å¢ç›¸é—œèª²ç¨‹ã€

2. æœå°‹åŠŸèƒ½åˆ†æ
   æ¢ä»¶ï¼šæœå°‹ä¾†æºä½”æ¯” > 40%
   å»ºè­°ï¼šã€Œæœå°‹åŠŸèƒ½ä½¿ç”¨ç‡é«˜ï¼Œç”¨æˆ¶èƒ½æ‰¾åˆ°æƒ³è¦çš„èª²ç¨‹ã€

3. æ¨è–¦æ•ˆæœåˆ†æ
   æ¢ä»¶ï¼šç›¸é—œèª²ç¨‹ä¾†æºä½”æ¯” > 20%
   å»ºè­°ï¼šã€Œç›¸é—œèª²ç¨‹æ¨è–¦æœ‰æ•ˆï¼Œç”¨æˆ¶æœƒé»æ“Šå»¶ä¼¸å­¸ç¿’ã€

4. æ¨™é¡Œå„ªåŒ–æé†’
   æ¢ä»¶ï¼šç†±é–€æœå°‹é—œéµå­— â‰  ç†±é–€èª²ç¨‹æ¨™é¡Œ
   å»ºè­°ï¼šã€Œç†±é–€æœå°‹ XXX èˆ‡ç†±é–€èª²ç¨‹ä¸åŒï¼Œå¯å„ªåŒ–èª²ç¨‹æ¨™é¡Œã€
```

### ğŸ’³ è¨‚é–± & æ”¯ä»˜ç³»çµ±

**è¨‚é–±æ–¹æ¡ˆ**

| æ–¹æ¡ˆ | åƒ¹æ ¼ | æœ‰æ•ˆæœŸ | å…§å®¹ |
|------|------|--------|------|
| å…è²» | $0 | âˆ | 28 å ‚åˆç´šèª²ç¨‹ã€æœå°‹ç¯©é¸ã€PRO èª²ç¨‹é è¦½ï¼ˆåƒ…å•é¡Œï¼‰ |
| 7å¤© PASS | $180 | 7 å¤© | å…¨éƒ¨ 213 å ‚èª²ç¨‹ã€æ”¶è—åŠŸèƒ½ã€ç·´ç¿’ç´€éŒ„ |
| 30å¤© PASS | $290 | 30 å¤© | å…¨éƒ¨ 213 å ‚èª²ç¨‹ã€æ”¶è—åŠŸèƒ½ã€ç·´ç¿’ç´€éŒ„ |
| PRO å¹´è²» | $690 | 365 å¤© | å…¨éƒ¨ 213+ å ‚èª²ç¨‹ã€æ”¶è—ã€ç·´ç¿’ç´€éŒ„ã€æœªä¾†æ–°å¢å…§å®¹ |

**æ”¯ä»˜æµç¨‹**

```
ç”¨æˆ¶é¸æ“‡æ–¹æ¡ˆ â†’ /pricing é é¢
    â†“
POST /api/payments/checkout (éœ€ç™»å…¥)
    â†“
é‡‘æµ SDK åˆå§‹åŒ– â†’ æ”¯ä»˜é é¢ (ÅŒEN Tech)
    â†“
æ”¯ä»˜å®Œæˆ â†’ POST /api/payments/webhook
    â†“
æ›´æ–°è¨‚é–±ç‹€æ…‹ â†’ å°å› /payment-success
    â†“
å‰ç«¯è¼ªè©¢ /api/payments/status
    â†“
AuthProvider è‡ªå‹•åˆ·æ–°è¨‚é–±ç‹€æ…‹ â†’ æ‰€æœ‰å—ä¿è­·é é¢ç«‹å³å¯ç”¨
```

**æ”¯ä»˜å®‰å…¨æ©Ÿåˆ¶**

- âœ… **ä¼ºæœå™¨æ™‚é–“é©—è­‰**ï¼šéæœŸæ—¥æœŸä½¿ç”¨çµ•å° UTC æ™‚é–“æˆ³ï¼Œé˜²æ­¢å®¢æˆ¶ç«¯æ™‚é–“ç¯¡æ”¹
- âœ… **Webhook å†ªç­‰æ€§**ï¼šå”¯ä¸€ç´¢å¼• on (provider, provider_payment_id) é˜²æ­¢é‡è¤‡è™•ç†
- âœ… **é‡è¤‡è³¼è²·é˜²æ­¢**ï¼šæª¢æŸ¥ç¾æœ‰æœ‰æ•ˆè¨‚é–±ï¼Œè¿”å› 409 Conflict
- âœ… **RLS æ”¿ç­–**ï¼šç”¨æˆ¶åªèƒ½å­˜å–è‡ªå·±çš„è¨‚é–±/æ”¶è—/ç·´ç¿’ç´€éŒ„
- âœ… **è¨‚é–±ç‹€æ…‹åŒæœŸ**ï¼šPayment Success é è‡ªå‹•èª¿ç”¨ refreshSubscription() æ›´æ–°ç‹€æ…‹

### å°ˆæ¡ˆçµæ§‹

```
web/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ page.tsx            # é¦–é 
â”‚   â”‚   â”œâ”€â”€ lesson/[id]/        # èª²ç¨‹è©³æƒ…
â”‚   â”‚   â”œâ”€â”€ favorites/          # æ”¶è—é 
â”‚   â”‚   â”œâ”€â”€ practice/           # ç·´ç¿’ç´€éŒ„
â”‚   â”‚   â”œâ”€â”€ pricing/            # ä»˜è²»æ–¹æ¡ˆ
â”‚   â”‚   â”œâ”€â”€ feedback/           # æ„è¦‹å›å ±
â”‚   â”‚   â”œâ”€â”€ login/              # ç™»å…¥é 
â”‚   â”‚   â”œâ”€â”€ admin/              # å¾Œå°
â”‚   â”‚   â””â”€â”€ api/admin/          # ğŸ”’ Admin Server APIï¼ˆ2025-11-29 æ–°å¢ï¼‰
â”‚   â”‚       â”œâ”€â”€ dashboard/      # Dashboard æ•¸æ“š API
â”‚   â”‚       â”œâ”€â”€ users/          # ç”¨æˆ¶ç®¡ç† API
â”‚   â”‚       â”œâ”€â”€ lessons/        # èª²ç¨‹åˆ†æ API
â”‚   â”‚       â”œâ”€â”€ monetization/   # ä»˜è²»åˆ†æ API
â”‚   â”‚       â””â”€â”€ subscription/   # è¨‚é–±é–‹é€š API
â”‚   â”‚
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ ui/                 # åŸå­çµ„ä»¶ï¼ˆButton, Loading, Stats...ï¼‰
â”‚   â”‚   â”œâ”€â”€ home/               # é¦–é çµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ lesson/             # èª²ç¨‹è©³æƒ…å­çµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ practice/           # ç·´ç¿’ç›¸é—œçµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ dashboard/          # å„€è¡¨æ¿çµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ AuthProvider.tsx    # èªè­‰ Context
â”‚   â”‚   â”œâ”€â”€ ErrorBoundary.tsx   # éŒ¯èª¤é‚Šç•Œ
â”‚   â”‚   â”œâ”€â”€ LessonCard.tsx      # èª²ç¨‹å¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ LessonDetail.tsx    # èª²ç¨‹è©³æƒ…
â”‚   â”‚   â”œâ”€â”€ SearchBar.tsx       # æœå°‹æ¬„
â”‚   â”‚   â””â”€â”€ SkeletonLesson.tsx  # è¼‰å…¥éª¨æ¶
â”‚   â”‚
â”‚   â””â”€â”€ lib/
â”‚       â”œâ”€â”€ supabase.ts         # Supabase Clientï¼ˆå‰ç«¯ï¼‰
â”‚       â”œâ”€â”€ supabaseServer.ts   # ğŸ”’ Supabase Service Roleï¼ˆå¾Œç«¯ï¼‰
â”‚       â”œâ”€â”€ auth.ts             # èªè­‰å‡½æ•¸
â”‚       â”œâ”€â”€ lessons.ts          # èª²ç¨‹ API
â”‚       â”œâ”€â”€ favorites.ts        # æ”¶è— API
â”‚       â”œâ”€â”€ practice.ts         # ç·´ç¿’ç´€éŒ„ API
â”‚       â”œâ”€â”€ improvement.ts      # æ”¹å–„åº¦è¨ˆç®—
â”‚       â”œâ”€â”€ analytics.ts        # äº‹ä»¶è¿½è¹¤
â”‚       â”œâ”€â”€ adminApi.ts         # ğŸ”’ Admin API å®¢æˆ¶ç«¯å°è£ï¼ˆ2025-11-29ï¼‰
â”‚       â”œâ”€â”€ adminData.ts        # ğŸ”’ Admin è³‡æ–™å±¤å°è£ï¼ˆ2025-11-29ï¼‰
â”‚       â”œâ”€â”€ subscription.ts     # è¨‚é–±æª¢æŸ¥
â”‚       â”œâ”€â”€ constants.ts        # å¸¸æ•¸å®šç¾©
â”‚       â”œâ”€â”€ retry.ts            # å¼±ç¶²é‡è©¦å·¥å…·
â”‚       â”œâ”€â”€ useAdminAuth.ts     # å¾Œå°é©—è­‰ Hook
â”‚       â””â”€â”€ useFilteredLessons.ts # ç¯©é¸ Hook
â”‚
â”œâ”€â”€ .env.local.example          # ç’°å¢ƒè®Šæ•¸ç¯„æœ¬
â””â”€â”€ package.json
```

### ç’°å¢ƒè®Šæ•¸

```bash
# .env.local
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key  # ğŸ”’ å¾Œç«¯å°ˆç”¨ï¼ˆ2025-11-29ï¼‰
NEXT_PUBLIC_ADMIN_PASSWORD=your-admin-password
```

**æ³¨æ„**ï¼š
- `NEXT_PUBLIC_*` æœƒæš´éœ²çµ¦å‰ç«¯ï¼Œåªèƒ½ç”¨æ–¼å…¬é–‹è³‡æ–™
- `SUPABASE_SERVICE_ROLE_KEY` åƒ…ç”¨æ–¼ server-side APIï¼Œå¯ç¹é RLS

### æœ¬åœ°é–‹ç™¼

```bash
cd web
npm install
npm run dev
```

### è³‡æ–™åº« Schema

ä¸»è¦è¡¨æ ¼ï¼š
- `lessons` - èª²ç¨‹å…§å®¹ï¼ˆğŸ”’ RLS å•Ÿç”¨ï¼Œpremium éœ€è¨‚é–±ï¼‰
- `users` - ç”¨æˆ¶è³‡æ–™ï¼ˆå«è¨‚é–±ç‹€æ…‹ï¼ŒğŸ”’ RLS å•Ÿç”¨ï¼‰
- `favorites` - æ”¶è—é—œè¯ï¼ˆğŸ”’ RLS å•Ÿç”¨ï¼Œéœ€è¨‚é–±ï¼‰
- `practice_logs` - ç·´ç¿’ç´€éŒ„ï¼ˆğŸ”’ RLS å•Ÿç”¨ï¼Œéœ€è¨‚é–±ï¼‰
- `event_log` - äº‹ä»¶è¿½è¹¤ï¼ˆğŸ”’ RLS å•Ÿç”¨ + rate-limitï¼‰
- `feedback` - ç”¨æˆ¶å›å ±
- `subscription_plans` - è¨‚é–±æ–¹æ¡ˆç‰ˆæœ¬åŒ–è¡¨ï¼ˆ2025-11-29 æ–°å¢ï¼‰

å®‰å…¨å‡½æ•¸ï¼š
- `is_subscription_active(user_id)` - æª¢æŸ¥è¨‚é–±æ˜¯å¦æœ‰æ•ˆï¼ˆä¼ºæœå™¨æ™‚é–“ï¼‰
- `assert_event_log_limits()` - event_log å¯«å…¥é™åˆ¶ï¼ˆrate-limit + å¤§å°ï¼‰

è©³è¦‹ï¼š
- [docs/schema.sql](docs/schema.sql) - åŸºç¤ Schema
- [docs/migration_subscription_security.sql](docs/migration_subscription_security.sql) - RLS æ”¿ç­–
- [docs/migration_event_log_guardrails.sql](docs/migration_event_log_guardrails.sql) - Rate limit
- [docs/migration_subscription_plans.sql](docs/migration_subscription_plans.sql) - æ–¹æ¡ˆç‰ˆæœ¬åŒ–

### å¾Œå°å®‰å…¨æ©Ÿåˆ¶

#### ä¸‰å±¤é©—è­‰
1. Supabase Auth ç™»å…¥
2. Email ç™½åå–®ï¼ˆ`ADMIN_EMAILS`ï¼‰
3. å¾Œå°å¯†ç¢¼ï¼ˆ`NEXT_PUBLIC_ADMIN_PASSWORD`ï¼‰

#### å®‰å…¨æ¶æ§‹ï¼ˆ2025-11-29 å¼·åŒ–ï¼‰

| å±¤ç´š | æ©Ÿåˆ¶ | èªªæ˜ |
|------|------|------|
| **å‰ç«¯** | API å°è£ | `adminApi.ts` çµ±ä¸€ token å–å¾—èˆ‡éŒ¯èª¤è™•ç† |
| **å‰ç«¯** | é—œæ³¨é»åˆ†é›¢ | `adminData.ts` å°è£æ‰€æœ‰ APIï¼Œé é¢åªè² è²¬ UI |
| **å¾Œç«¯** | Server API | æ‰€æœ‰ admin æŸ¥è©¢æ”¹ç”± `/api/admin/*` åŸ·è¡Œ |
| **å¾Œç«¯** | Service Key | ä½¿ç”¨ service role keyï¼Œç¹é RLS |
| **å¾Œç«¯** | is_admin æª¢æŸ¥ | æ¯å€‹ API éƒ½é©—è­‰ `users.is_admin = true` |
| **è³‡æ–™åº«** | RLS æ”¿ç­– | `users`/`lessons`/`favorites`/`practice_logs` å•Ÿç”¨ RLS |
| **è³‡æ–™åº«** | è¨‚é–±æª¢æŸ¥ | `is_subscription_active()` å‡½æ•¸ï¼ˆä¼ºæœå™¨æ™‚é–“ï¼‰ |
| **è³‡æ–™åº«** | Premium é˜²è­· | éè¨‚é–±ç”¨æˆ¶ç„¡æ³•è®€å– premium èª²ç¨‹ |
| **è³‡æ–™åº«** | Rate Limit | event_log é™åˆ¶ 120 æ¬¡/åˆ†é˜ï¼ˆç”¨æˆ¶ï¼‰ã€60 æ¬¡/åˆ†é˜ï¼ˆåŒ¿åï¼‰ |
| **è³‡æ–™åº«** | å¤§å°é™åˆ¶ | event_log metadata é™åˆ¶ 4000 å­—å…ƒ |

#### å®‰å…¨æ”¹å–„æ•ˆæœ

**æ”¹å–„å‰**ï¼š
- âŒ å‰ç«¯ç›´æ¥ç”¨ anon key æŸ¥è©¢æ•æ„Ÿè³‡æ–™
- âŒ å®¢æˆ¶ç«¯å¯ç¹éè¨‚é–±æª¢æŸ¥ï¼ˆä¿®æ”¹æœ¬åœ°æ™‚é–“ï¼‰
- âŒ event_log å¯è¢«æ¿«ç”¨ï¼ˆç„¡é™å¯«å…¥ï¼‰
- âŒ è¨‚é–±æ–¹æ¡ˆè®Šæ›´æœƒå½±éŸ¿è€ç”¨æˆ¶

**æ”¹å–„å¾Œ**ï¼š
- âœ… æ•æ„Ÿè³‡æ–™åªèƒ½é€é server API + service key å­˜å–
- âœ… è¨‚é–±æª¢æŸ¥ä½¿ç”¨ä¼ºæœå™¨æ™‚é–“ï¼ˆ`is_subscription_active()`ï¼‰
- âœ… event_log æœ‰ rate-limit å’Œå¤§å°é™åˆ¶
- âœ… è¨‚é–±æ–¹æ¡ˆç‰ˆæœ¬åŒ–ï¼Œä¿ç•™æ­·å²æ–¹æ¡ˆ
- âœ… RLS æ”¿ç­–ç¢ºä¿è³‡æ–™éš”é›¢ï¼ˆç”¨æˆ¶åªèƒ½å­˜å–è‡ªå·±çš„è³‡æ–™ï¼‰
- âœ… Premium èª²ç¨‹å— RLS ä¿è­·ï¼ˆéœ€æœ‰æ•ˆè¨‚é–±ï¼‰

#### ç›¸é—œæª”æ¡ˆ

```
web/src/
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ adminApi.ts          # å®¢æˆ¶ç«¯ API å°è£ï¼ˆtoken + éŒ¯èª¤è™•ç†ï¼‰
â”‚   â”œâ”€â”€ adminData.ts         # Admin API èª¿ç”¨å°è£
â”‚   â””â”€â”€ supabaseServer.ts    # Service Role Client
â”‚
â”œâ”€â”€ app/api/admin/
â”‚   â”œâ”€â”€ dashboard/route.ts   # Dashboard APIï¼ˆserver-sideï¼‰
â”‚   â”œâ”€â”€ users/route.ts       # ç”¨æˆ¶ç®¡ç† API
â”‚   â”œâ”€â”€ lessons/route.ts     # èª²ç¨‹åˆ†æ API
â”‚   â”œâ”€â”€ monetization/route.ts # ä»˜è²»åˆ†æ API
â”‚   â””â”€â”€ subscription/route.ts # è¨‚é–±é–‹é€š API
â”‚
docs/
â”œâ”€â”€ migration_subscription_security.sql    # RLS + is_subscription_active
â”œâ”€â”€ migration_event_log_guardrails.sql     # Rate limit + å¤§å°é™åˆ¶
â”œâ”€â”€ migration_subscription_plans.sql       # æ–¹æ¡ˆç‰ˆæœ¬åŒ–è¡¨
â””â”€â”€ SMOKE_AUTH_SUBSCRIPTION.md             # æ¬Šé™é©—è­‰æ¸¬è©¦ç”¨ä¾‹
```

---

## ğŸ“± åŠŸèƒ½ç‰¹è‰²

### é¦–é ï¼ˆåˆ—è¡¨ï¼‰

| åŠŸèƒ½ | èªªæ˜ |
|------|------|
| ğŸ” æœå°‹ | é—œéµå­—æœå°‹å•é¡Œã€æ¨™é¡Œã€ç›®æ¨™ |
| ç¯©é¸-ç¨‹åº¦ | åˆç´š / ä¸­ç´š / é€²éš |
| ç¯©é¸-é›ªé“ | ç¶ é“ / è—é“ / é»‘é“ / è˜‘è‡ / ç²‰é›ª / å…¬åœ’ / æ¨¹æ— |
| ç¯©é¸-æŠ€èƒ½ | CASI äº”é …æ ¸å¿ƒæŠ€èƒ½ |
| å•é¡Œå„ªå…ˆ | å¡ç‰‡æœ€ä¸Šæ–¹é¡¯ç¤ºå•é¡Œï¼Œå¿«é€Ÿå°è™Ÿå…¥åº§ |

### è©³æƒ…é 

| å€å¡Š | å…§å®¹ |
|------|------|
| ğŸ˜° å•é¡Œ | å­¸ç”Ÿå¸¸è¦‹çš„æŠ€è¡“å•é¡Œæè¿° |
| ğŸ¯ ç›®æ¨™ | æ”¹å–„é€™å€‹å•é¡Œçš„ç›®çš„æˆ–å¥½è™• |
| ğŸ› ï¸ æ€éº¼ç·´ | å…·é«”çš„å‹•ä½œè¦é»æˆ–ç·´ç¿’æ­¥é©Ÿ |
| âœ… åšå°è¨Šè™Ÿ | ç·´ç¿’æ­£ç¢ºæ™‚çš„èº«é«”æ„Ÿå—æˆ–è¦–è¦ºå›é¥‹ |
| âŒ åšéŒ¯è¨Šè™Ÿ | ç·´ç¿’éŒ¯èª¤æ™‚çš„è­¦ç¤ºè¨Šè™Ÿ |
| ğŸ“š CASI åˆ†é¡ | ä¸»è¦æŠ€èƒ½ã€æ ¸å¿ƒèƒ½åŠ›åˆ†é¡ |

### CASI äº”é …æ ¸å¿ƒæŠ€èƒ½

1. **ç«™å§¿èˆ‡å¹³è¡¡** - å±…ä¸­ä¸”éˆæ´»çš„ç«™å§¿
2. **æ—‹è½‰** - ç”¨ä¸‹è‚¢è½‰å‹•æ»‘é›ªæ¿
3. **ç”¨åˆƒ** - åœ¨æœ‰æ•ˆé‚Šåˆƒä¸Šä¿æŒå¹³è¡¡
4. **å£“åŠ›** - æ§åˆ¶æ¿çš„å£“åŠ›èˆ‡è®Šå½¢
5. **æ™‚æ©Ÿèˆ‡å”èª¿æ€§** - å‹•ä½œæ™‚åºèˆ‡æµæš¢åº¦

---

## ğŸ“Š è³‡æ–™æ ¼å¼

æ¯ç­†æ•™å­¸è³‡æ–™çµæ§‹ï¼š

```json
{
  "id": "01",
  "title": "æ»¾åˆƒå¿«æ›åˆƒï¼šå°‘ç«™ç›´ç¸®å°å¼§åº¦",
  "level_tags": ["intermediate"],
  "slope_tags": ["blue"],
  "is_premium": false,
  "what": "å•é¡Œæè¿°...",
  "why": ["ç›®æ¨™1", "ç›®æ¨™2"],
  "how": [
    {"text": "æ­¥é©Ÿèªªæ˜", "image": null}
  ],
  "signals": {
    "correct": ["åšå°è¨Šè™Ÿ1", "åšå°è¨Šè™Ÿ2"],
    "wrong": ["åšéŒ¯è¨Šè™Ÿ1"]
  },
  "casi": {
    "Primary_Skill": "ç”¨åˆƒ",
    "Core_Competency": "å±…ä¸­ä¸”éˆæ´»çš„ç«™å§¿"
  }
}
```

---

## ğŸ“ˆ çµ±è¨ˆ

- æ•™å­¸æ–‡ä»¶ç¸½æ•¸ï¼š213 å€‹
- å…è²»èª²ç¨‹ï¼š28 å ‚ï¼ˆåˆç´šï¼‰
- PRO èª²ç¨‹ï¼š185 å ‚ï¼ˆä¸­ç´š/é€²éšï¼‰
- ç¨‹åº¦åˆ†é¡ï¼šåˆç´š / ä¸­ç´š / é€²éš
- é›ªé“åˆ†é¡ï¼š9 ç¨®ï¼ˆç¶ é“ã€è—é“ã€é»‘é“ã€è˜‘è‡ã€ç²‰é›ªã€å…¬åœ’ã€æ¨¹æ—ã€å¹³åœ°ã€å…¨åœ°å½¢ï¼‰
- CASI æŠ€èƒ½ï¼š5 é …

---

## âœ… å·²å®ŒæˆåŠŸèƒ½

### å‰å°
- [x] èª²ç¨‹åˆ—è¡¨èˆ‡æœå°‹
- [x] åˆ†é¡ç¯©é¸ï¼ˆç¨‹åº¦/é›ªé“/æŠ€èƒ½ï¼‰
- [x] èª²ç¨‹è©³æƒ…é 
- [x] ç”¨æˆ¶ç™»å…¥/è¨»å†Š
- [x] æ”¶è—åŠŸèƒ½
- [x] ç·´ç¿’ç´€éŒ„
- [x] ä»˜è²»æ–¹æ¡ˆé 
- [x] æ„è¦‹å›å ±

### å¾Œå°
- [x] Dashboardï¼ˆDAU/WAU/ç†±é–€èª²ç¨‹/æœå°‹/å›å ±ï¼‰
- [x] ç”¨æˆ¶ç®¡ç†ï¼ˆæœå°‹/é–‹é€šè¨‚é–±ï¼‰
- [x] å›å ±ç®¡ç†
- [x] èª²ç¨‹åˆ†æ
- [x] ä»˜è²»åˆ†æ

### äº‹ä»¶è¿½è¹¤
- [x] èª²ç¨‹ç€è¦½
- [x] æœå°‹é—œéµå­—
- [x] ä»˜è²»é ç€è¦½
- [x] æ”¶è—æ“ä½œ
- [x] ç·´ç¿’å®Œæˆ

### Clean Code é‡æ§‹
- [x] constants.ts - çµ±ä¸€å¸¸æ•¸
- [x] ui.tsx - å…±ç”¨çµ„ä»¶
- [x] useFilteredLessons - ç¯©é¸é‚è¼¯æŠ½é›¢
- [x] LessonDetail æ‹†åˆ†å­çµ„ä»¶
- [x] AdminLayout çµ±ä¸€å¾Œå°é©—è­‰
- [x] useAdminAuth Hook
- [x] **å®‰å…¨æ€§å¼·åŒ–ï¼ˆ2025-11-29ï¼‰**
  - ç§»é™¤å®¢æˆ¶ç«¯ç›´é€£ Supabaseï¼ˆAdmin/metrics/monetizationï¼‰
  - Admin API ä¼ºæœå™¨åŒ–ï¼ˆservice key + RLSï¼‰
  - å®¢æˆ¶ç«¯ API å°è£ï¼ˆadminApi.ts + adminData.tsï¼‰
  - å‰ç«¯é—œæ³¨é»åˆ†é›¢ï¼ˆé é¢åªè² è²¬ UIï¼‰
  - event_log å¾Œç«¯æ ¡é©—/ç¯€æµï¼ˆrate-limit + å¤§å°é™åˆ¶ï¼‰
  - è¨‚é–±æ–¹æ¡ˆç‰ˆæœ¬åŒ–ï¼ˆDB æ–¹æ¡ˆè¡¨ + æ­·å²ä¿ç•™ï¼‰
  - æ¬Šé™é©—è­‰ Smoke Testsï¼ˆæœªè¨‚é–±/è¨‚é–±ä¸­/adminï¼‰

### UX å„ªåŒ–ï¼ˆ2025-11-28ï¼‰
- [x] æ‰‹æ©Ÿå„ªå…ˆæ”¹é€ ï¼ˆå¡ç‰‡ç°¡åŒ–ã€æ°´å¹³æ»‘å‹•ã€åˆ†æ®µè©•åˆ†ï¼‰
- [x] Alpine Velocity ç¾å­¸ç³»çµ±ï¼ˆå­—é«”ã€æ–œåˆ‡è§’ã€å…‰å½±å‹•æ•ˆï¼‰
- [x] è‡ªå‹•åµæ¸¬æ•¸å­—æ¨™é ­åˆ†æ®µé¡¯ç¤º

---

## ğŸ—ºï¸ æœªä¾†è¦åŠƒ

**å·²å®Œæˆ**
- âœ… é‡‘æµç³»çµ±ï¼ˆÅŒEN Techï¼‰
- âœ… è¨‚é–±ç®¡ç†ï¼ˆå…è²»/çŸ­æœŸ PASS/å¹´è²»ï¼‰
- âœ… å¾Œå°æ•¸æ“šåˆ†æï¼ˆDashboard/èª²ç¨‹åˆ†æ/ä»˜è²»åˆ†æï¼‰
- âœ… ç”¨æˆ¶èªè­‰èˆ‡æˆæ¬Šï¼ˆSupabase Auth + RLSï¼‰
- âœ… Alpine Velocity ç¾å­¸ç³»çµ±

**å„ªå…ˆé–‹ç™¼**
- [ ] **æ¨æ’­æé†’**
  - å³å°‡éæœŸæé†’ï¼ˆ7å¤©å‰ï¼‰
  - æ–°èª²ç¨‹ä¸Šç·šé€šçŸ¥
  - ç·´ç¿’æˆç¸¾æ”¹å–„æé†’

- [ ] **å€‹äººåŒ–æ©Ÿåˆ¶**
  - å­¸ç¿’é€²åº¦å„€è¡¨æ¿ï¼ˆé€²åº¦æ¢/æ™‚é–“çµ±è¨ˆï¼‰
  - å€‹äººåŒ–èª²ç¨‹æ¨è–¦ï¼ˆåŸºæ–¼ç€è¦½/ç·´ç¿’æ­·å²ï¼‰
  - æ”¹å–„è¨ˆç•«è·Ÿè¹¤ï¼ˆé‡å°å¼±é …èª²ç¨‹è‡ªå‹•æ¨è–¦ï¼‰

- [ ] **å…§å®¹æ“´å±•**
  - AI ç”Ÿæˆç¤ºæ„åœ–ï¼ˆåŸºæ–¼èª²ç¨‹æ–‡å­—ï¼‰
  - CASI Level 2/3 é€²éšå…§å®¹
  - å­£ç¯€æ€§èª²ç¨‹ï¼ˆæ–°é›ªå­£æ›´æ–°å…§å®¹ï¼‰
  - ç”¨æˆ¶è²¢ç»å…§å®¹ï¼ˆç¤¾ç¾¤èª²ç¨‹ï¼‰

**æœªä¾†è€ƒæ…®**
- [ ] é›¢ç·šæ¨¡å¼ï¼ˆOffline-first PWAï¼‰
- [ ] ç¤¾ç¾¤åŠŸèƒ½ï¼ˆèª²ç¨‹è¨è«–/ç¶“é©—åˆ†äº«ï¼‰
- [ ] æ•™ç·´ç«¯å¹³å°ï¼ˆå­¸ç”Ÿç®¡ç†/é€²åº¦è¿½è¹¤ï¼‰
- [ ] å¤šèªè¨€æ”¯æ´ï¼ˆä¸­æ–‡/è‹±æ–‡/æ—¥æ–‡ï¼‰
- [ ] å°çµ„è¨“ç·´èª²ç¨‹ï¼ˆç­ç´šç®¡ç†ï¼‰

---

## ğŸ“š é–‹ç™¼æ–‡ä»¶

æ‰€æœ‰æ–‡ä»¶çµ±ä¸€æ”¾åœ¨ [docs/](docs/) ç›®éŒ„ï¼Œè©³è¦‹ [FILE_ORGANIZATION.md](docs/FILE_ORGANIZATION.md)

### æ ¸å¿ƒæ–‡ä»¶

| æ–‡ä»¶ | èªªæ˜ |
|------|------|
| [SDD.md](docs/SDD.md) | è»Ÿé«”è¨­è¨ˆæ–‡ä»¶ |
| [PLAN.md](docs/PLAN.md) | é–‹ç™¼è¨ˆç•« |
| [TODO.md](docs/TODO.md) | å¾…è¾¦æ¸…å–® |
| [FILE_ORGANIZATION.md](docs/FILE_ORGANIZATION.md) | ğŸ“ æª”æ¡ˆçµ„ç¹”èªªæ˜ |

### è³‡æ–™åº«

| æ–‡ä»¶ | èªªæ˜ |
|------|------|
| [schema.sql](docs/schema.sql) | è³‡æ–™åº« Schema |
| [migration_subscription_security.sql](docs/migration_subscription_security.sql) | ğŸ”’ RLS æ”¿ç­– + è¨‚é–±æª¢æŸ¥å‡½æ•¸ |
| [migration_event_log_guardrails.sql](docs/migration_event_log_guardrails.sql) | ğŸ”’ event_log Rate Limit |
| [migration_subscription_plans.sql](docs/migration_subscription_plans.sql) | ğŸ”’ è¨‚é–±æ–¹æ¡ˆç‰ˆæœ¬åŒ–è¡¨ |
| [migration_payments.sql](docs/migration_payments.sql) | ğŸ’³ é‡‘æµç³»çµ± |

### UX/UI è¨­è¨ˆ

| æ–‡ä»¶ | èªªæ˜ |
|------|------|
| [Alpine_Velocity_å¯¦ä½œå ±å‘Š_2025-11-28.md](docs/Alpine_Velocity_å¯¦ä½œå ±å‘Š_2025-11-28.md) | Alpine Velocity ç¾å­¸å¯¦ä½œ |
| [Alpine_Velocity_é€²éšå„ªåŒ–_2025-11-28.md](docs/Alpine_Velocity_é€²éšå„ªåŒ–_2025-11-28.md) | è¦–è¦ºæ·±åº¦èˆ‡å¾®å‹•æ•ˆå„ªåŒ– |
| [UX_ç¬¬å››è¼ªå»ºè­°_æ‰‹æ©Ÿå„ªå…ˆ_2025-11-28.md](docs/UX_ç¬¬å››è¼ªå»ºè­°_æ‰‹æ©Ÿå„ªå…ˆ_2025-11-28.md) | æ‰‹æ©Ÿå„ªå…ˆ UX æ”¹å–„æ–¹æ¡ˆ |

### å®‰å…¨æ€§èˆ‡æ¸¬è©¦

| æ–‡ä»¶ | èªªæ˜ |
|------|------|
| [å®‰å…¨æ€§å¼·åŒ–å ±å‘Š_2025-12-01.md](docs/å®‰å…¨æ€§å¼·åŒ–å ±å‘Š_2025-12-01.md) | ğŸ”’ å®‰å…¨æ€§å¼·åŒ–ç¸½çµ |
| [SMOKE_AUTH_SUBSCRIPTION.md](docs/SMOKE_AUTH_SUBSCRIPTION.md) | ğŸ”’ æ¬Šé™é©—è­‰æ¸¬è©¦ç”¨ä¾‹ |
| [PAYMENTS.md](docs/PAYMENTS.md) | ğŸ’³ æ”¯ä»˜ç³»çµ±å®Œæ•´æ–‡ä»¶ï¼ˆè¦åŠƒ/æ¸¬è©¦/å ±å‘Šï¼‰ |

### éƒ¨ç½²èˆ‡ç¶­è­·

| æ–‡ä»¶ | èªªæ˜ |
|------|------|
| [PRODUCTION_DEPLOYMENT.md](docs/PRODUCTION_DEPLOYMENT.md) | ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²æŒ‡å— |
| [LINUS_GUIDE.md](docs/LINUS_GUIDE.md) | Linus åŸå‰‡æŒ‡å— |

---

---

## ğŸ”’ å®‰å…¨æ€§å¼·åŒ–ç¸½çµï¼ˆ2025-11-29ï¼‰

### é …ç›® 125-130ï¼šClean Code + Linus é‡æ§‹è¡Œå‹•

é€™æ¬¡é‡æ§‹ä¸»è¦è§£æ±ºäº†**å®‰å…¨æ€§æ¼æ´**å’Œ**æ¶æ§‹å•é¡Œ**ï¼Œç¢ºä¿æ•æ„Ÿè³‡æ–™ä¸æœƒè¢«å‰ç«¯ç›´æ¥å­˜å–ã€‚

#### æ”¹å–„é …ç›®

| # | é …ç›® | æ”¹å–„å‰ | æ”¹å–„å¾Œ |
|---|------|--------|--------|
| 125 | æ•æ„Ÿè³‡æ–™è¨ªå• | å‰ç«¯ç”¨ anon key ç›´é€£ Supabase | æ”¹èµ° server API + service key |
| 126 | API å®¢æˆ¶ç«¯å°è£ | æ¯å€‹é é¢é‡è¤‡ fetch é‚è¼¯ | `adminApi.ts` çµ±ä¸€è™•ç† |
| 127 | é—œæ³¨é»åˆ†é›¢ | é é¢æ··é›œè³‡æ–™é‚è¼¯ | `adminData.ts` å°è£ï¼Œé é¢åªè² è²¬ UI |
| 128 | event_log é˜²è­· | ç„¡é™åˆ¶ï¼Œå¯è¢«æ¿«ç”¨ | Rate-limit + å¤§å°é™åˆ¶ |
| 129 | æ–¹æ¡ˆç‰ˆæœ¬åŒ– | å‰ç«¯å¸¸æ•¸ï¼Œç„¡æ­·å²ç´€éŒ„ | DB æ–¹æ¡ˆè¡¨ + ç‰ˆæœ¬æ§åˆ¶ |
| 130 | æ¬Šé™é©—è­‰æ¸¬è©¦ | ç„¡æ¸¬è©¦ç”¨ä¾‹ | Smoke Tests æ–‡ä»¶ |

#### æ ¸å¿ƒæ”¹å–„

**1. ä¸‰å±¤æ¶æ§‹åˆ†é›¢**
```
å‰ç«¯ï¼ˆUIï¼‰â†’ adminData.tsï¼ˆè³‡æ–™å±¤ï¼‰â†’ /api/admin/*ï¼ˆServer APIï¼‰â†’ Supabaseï¼ˆservice keyï¼‰
```

**2. å®‰å…¨é˜²è­·æ©Ÿåˆ¶**
- âœ… RLS æ”¿ç­–ï¼šç”¨æˆ¶åªèƒ½å­˜å–è‡ªå·±çš„è³‡æ–™
- âœ… è¨‚é–±æª¢æŸ¥ï¼šä½¿ç”¨ä¼ºæœå™¨æ™‚é–“ï¼Œç„¡æ³•ç¹é
- âœ… Premium é˜²è­·ï¼šéè¨‚é–±ç”¨æˆ¶ç„¡æ³•è®€å– premium èª²ç¨‹
- âœ… Rate Limitï¼ševent_log é™åˆ¶ 120 æ¬¡/åˆ†é˜
- âœ… å¤§å°é™åˆ¶ï¼šmetadata é™åˆ¶ 4000 å­—å…ƒ

**3. å¯ç¶­è­·æ€§æå‡**
- âœ… çµ±ä¸€éŒ¯èª¤è™•ç†ï¼ˆ`adminApi.ts`ï¼‰
- âœ… çµ±ä¸€ token å–å¾—ï¼ˆé¿å…é‡è¤‡ä»£ç¢¼ï¼‰
- âœ… å‹åˆ¥å®‰å…¨ï¼ˆTypeScript interfacesï¼‰
- âœ… æ¸¬è©¦ç”¨ä¾‹ï¼ˆSmoke Testsï¼‰

#### å½±éŸ¿ç¯„åœ

**ä¿®æ”¹çš„æª”æ¡ˆ**ï¼š
- `web/src/lib/adminApi.ts` - æ–°å¢
- `web/src/lib/adminData.ts` - æ–°å¢
- `web/src/lib/supabaseServer.ts` - æ–°å¢
- `web/src/app/api/admin/**/*.ts` - æ–°å¢ 5 å€‹ API è·¯ç”±
- `web/src/app/admin/**/*.tsx` - æ”¹ç”¨ `adminData.ts`
- `docs/migration_subscription_security.sql` - æ–°å¢
- `docs/migration_event_log_guardrails.sql` - æ–°å¢
- `docs/migration_subscription_plans.sql` - æ–°å¢
- `docs/SMOKE_AUTH_SUBSCRIPTION.md` - æ–°å¢

**ç¨‹å¼ç¢¼å“è³ª**ï¼š
- âœ… ç§»é™¤ 21 è™• `console.log`
- âœ… çµ±ä¸€å‹åˆ¥ä½¿ç”¨ `lesson-v3.ts`
- âœ… æ¶ˆé™¤é‡è¤‡æ¨£å¼ï¼ˆ`PageContainer` çµ„ä»¶ï¼‰
- âœ… Build æˆåŠŸé€šé

---

*æœ€å¾Œæ›´æ–°ï¼š2025-12-07*
